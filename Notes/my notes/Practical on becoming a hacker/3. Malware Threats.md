## What is Malware

- *Malware* : is a set of instructions( program ) that run on computers and make the system do something than an attacker wants it to do.
- The name malware comes from :
     - *Malicious*  =>  desire to cause harm
     - *Software*  =>  set of instructions 
         -  *Mal*  +  *ware* 
- For reference : https://www.cisco.com/site/us/en/learn/topics/security/what-is-malware.html

## What malwares do

1. Removing data / files
2. Encrypting data / files
3. Corrupting data / files
4. Stealing data / files
5. Spying on user  and etc.

## Types of malwares

- Based on their *propagation / infection* and *attack*, there are many kinds of malwares.

### 1. Trojan
- is a type of malicious code or software that looks *legitimate* but can take control of your computer.
- it is designed to : 
     1. *damage*
     2. *disrupt*
     3. *steal*
     4. or inflict harmful action on your data or network.
- They don't *replicate*.
- The name Trojan came from the *Greek mythology* Trojan Horse.

#### Common types of Trojan
1. *Backdoor Trojan*
     - This Trojan can create a *back door* on your computer. It lets an attacker access your computer and control it.
     - Your data can be downloaded by a third party and stolen or more malware can be uploaded.
2. *Mailfinder Trojan*
     - This Trojan seeks to steal the email addresses you have on your device.
3. *Remote access Trojan* 
     - This Trojan can give an attacker full control over your computer via a remote network connection.
     - *C2 server* (command and control) : This is the server with which the malware communicate with to pass commands.
4. *Trojan banker* 
     - This Trojan takes aim at your financial accounts.
     - It is designed to steal your account info for all the things you do online like banking data, credit cards and bill pay.

### 2. Worm
- A computer worm can propagate or *self-replicate* from one computer to another without human interaction after breaching a system.
- A worm spreads across a network through your *Internet* or *LAN*.
- It damages files on the system and also damages the system itself.

### 3. Virus
- They are older and most known (famous).
- *Virus* : is a program written to get into your computer and damage / alter your files / data.
- A virus might corrupt or delete data on your computer.
- Virus can also *replicate* themselves.
- A computer virus is more dangerous because it can make changes or delete your files.

#### Common signs of virus infection
- Speed of System (reduced)
- Pop-up window (occurs)
- Self-executing
- Account being log out
- Crashing of devices
- Mass emails being sent from you
- Files and system settings are altered

#### Common types of Virus
1. *Resident Virus*
     - Viruses propagate by *infecting applications on a host computer*.
     - A resident virus achieves this by infecting applications as they are opened by a user.
     - *Non-resident virus* : is capable of infecting executable files when programs are not running.
2. *Multipartite Virus*
     - It uses multiple methods to infect and spread across computers.
     - It typically remains in the computer's memory to infect the hard disk, then spread through and infect more drives by altering the content of the applications.
3. *Browser Hijacker* 
     - It manually changes the settings of a web browsers, such as :
         - replacing the homepage
         - editing the new tab page
         - changing the default search engine
     - Technically it is not a virus because it can't infect files.

### 4. Ransomware
- *Ransomware* : is a malware that employs encryption to hold a victim's information at ransom.
- A user or organization's critical data is encrypted so that they cannot access files, databases, or applications and a ransom is demanded to provide access.
- Ransomware is often designed to spread across a network and target database and file servers, and can thus quickly paralyze an entire organization.
- Ransomware  =>  *Ransom*  +   *software*

### 5. Rootkit
- *Rootkit* : is a malicious software bundle designed to give unauthorized access to a computer or other software.
- Rootkit are hard to *detect* and can conceal their presence within an infected system.
- Hackers use rootkit malware to 
     - remotely access your computer
     - manipulate it and
     - steal data.

### 6. Adware
- *Adware* or (advertising supported software) : is a software that displays unwanted advertisements on your computer.
- Adware programs will 
     - tend to serve you pop-up ads 
     - can change your browser's homepage
     - add spyware and just bombard your device with advertisements.

## How do malware infect

1. Using USB drop attack ( infected removable drives )
2. Spam emails
3. Malicious office macros
4. Software / Applications from unsafe websites ( torrent sites )
5. Using cracked software
6. Using malicious browser extension

##### Website for further understanding
1. https://www.vectra.ai/topics/malware
2. https://www.malwarebytes.com/malware

## How malwares are undetected by Anti-Malware

- One of the protection method from Malware is using *anti-malware* or *anti-virus*.
- But how does anti-malware know if something is a malware or not ?
     - This can be based on different things but most anti-malware work by :
         - *detecting the file hash / signature* and save the *IOC* ( indicator of compromise ) of that virus.
         - https://www.xcitium.com/blog/malware/what-is-antimalware/
##### Note
- website for how malwares are undetectable by anti-malware :
     1. https://www.malwarebytes.com/cybersecurity/basics/undetected-malware

### Hackers use different methods to pass some protections and infect the system
1. *Packers* 
     - is a program that *compresses an executable to make it smaller*.
     - It wraps the compressed executable in the code necessary to decompress itself at runtime.
     - Packing changes the *binary pattern* and *some hashes* , so the anti-malware may not detect the packed file.
2. *Crypters / encoders*
     - it is similar to a packer but adds additional obfuscation or encryption to the mix.
     - Like packer its goal is to change the *binary fingerprint* of a file to avoid detection.
     - In a nutshell, the crypter encrypts the original executable using an encryption algorithm - often something as simple as *XOR cipher* with a unique key.
3. *Polymorphic malware*
     - it is a malware that repeatedly uses *packing* and *crypting* methods to change the way it looks / appears.
4. *Downloaders, Droppers, and Staged Loading* 
     - Many kinds of malware use staging programs called droppers or downloaders to learn about a system before installing the real malware.
     - Some of these droppers scope out a system first to avoid triggering security alerts when they download and install the real payload.
##### websites
1. https://www.threatdown.com/blog/explained-packer-crypter-and-protector/
2. https://stinet.pl/en/anatomy-of-attack-3-malware-delivery-exploitation/
3. https://www.darkreading.com/cyberattacks-data-breaches/how-hackers-hide-their-malware-the-basics
4. https://www.tripwire.com/state-of-security/understanding-how-polymorphic-and-metamorphic-malware-evades-detection-infect

### Malware prevention
1. Install anti-virus and anti-spyware software
     - Ex.  *Kaspersky*, *avg*, *smadav* and etc.
2. Use secure authentication methods
     -  2-factor authentication
     -  Implement email security and spam protection
3. Keep software updated
4. Use the least-privilege model
5. Monitor for suspicious activity
6. Educate your users

### Malware History
- See the given pic  [[Pasted image 20240521130815.png]] 

## Python for Malware development

- Malwares do so many things and we can develop that malware based on the algorithm we want or need.
- First we have to understand what our malware has to do.
- There are different kinds of purpose a malware can do :
     - *Delete files*
     - *Encrypt files*
     - *Corrupt files* and etc.
- Then you can convert your python file to executable(exe) by *py2exe* technics
##### Note
- When developing malwares we use low level programming languages like :
     - C  and C++
- The reason we use low level languages is because they are not easy to be detected by anti-malwares unlike high level programming languages which are easy to be detected.

#### 1. File deleting malware
- The algorithm is simple :
     - When it loads the program will delete files
- When writing our python code we need to import the *os* package :
     -  *import os* 
- *OS package* : is a module that helps us to interact and do some terminal commands.
- The code is on Linux on test folder ( virus.py ) 

## File Handling in python

- *File* is a container in a computer system for storing information. 
- Files used in computers are similar in features to that of paper documents used in library and office files.
- Files are used to store data in storage devices.
- When we want to read form or write to a file :
     - we need to open it
     - and when we are done we need to close it.
- In python, a file operation takes place in the following order :
     - open a file
     - read or write ( perform operations )
     - close the file 
- Python has a built-in function called *open()*.
- Syntax :
     - *with open ("filename or file path", 'x')  as var :* 
- Modes :
     - write              ----------- w
     - read               ----------- r
     - append          ----------- a
     - create            ----------- x
     - text mode      ----------- t
     - binary mode  ----------- b
- Example :
     - *with open ("filename", 'w')  as var :*
     - *with open ("filename", 'rt')  as var :*  -> rt ~ r    = text mode is default
##### Note
- The reason we use *with* is when code finishes what is written on the indentation it closes or goes out of the open function unlike when using *open* only where we need to close our function before we move on to the next code.

### Write on files
- In order to write on a file we have to open it in : 
     - *write*
     - *append* 
     - *create*  mode
- *Note* :  
     - When we use *w* it will overwrite the existing file so we use *append  'a'*. 
- Syntax : 
     - *var.write ("Hello world")* 
     - [[Pasted image 20240521181419.png]] 

### Reading files
- To read files on python we have to open it on reading mode *'r'* 
- We can use different methods :
     1.  *read ()* : it reads up to the inputted size number or until the end.
     2.  *readline ()* :  to read files only one line
     3.  *readlines ()* :  reads all files in 1 line
- Syntax :
     -  *var.read (5)*
     -  *var.readline ()*
     -  *var.readlines ()* 
     - [[Pasted image 20240521182156.png]]  
### Create file
- You just need to add the *x* on the type  [[Pasted image 20240521182509.png]] 
- But make sure that the file doesn't exist because if it exist there will file exist error.
- To pass file exist error do the following.  [[Pasted image 20240521182623.png]] 

#### 2. File ransomware
- We are going to create our own ransomware.
- So how do ransomware work or what is their *algorithm*
     - They scan the system files
     - Then they encrypt them with some key
- We will also create the decrypter too
     - It accepts the key
     - Decrypt the system files
- We will be using the *Fernet module* from the cryptography package.
- The ransomware and the decrypter are in *test ransomware* folder.

## Malware Analysis

- *Malware analysis* : is the study of the unique features, objectives, sources, and potential effects of harmful software and code, such as spyware, viruses, malvertising, and ransomware. It analyzes malware code to understand how it varies from other kinds.
- When a system is infected with malware, Security testers will do analysis on that malware.
- They hold the malware as sample and it is called *artifact*. 
- There are 2 types of analysis :
     1. *Static analysis* : It is analyzing the virus by just seeing the *byte code* and the *meta date*. 
     2. *Dynamic Analysis* : is a process of analyzing the virus by running the malware in Sandbox / virtual machine. Then they try to understand the malware behavior.

##### Websites
1. https://www.fortinet.com/resources/cyberglossary/malware-analysis
2. https://www.crowdstrike.com/cybersecurity-101/malware/malware-analysis/
3. https://www.geeksforgeeks.org/introduction-to-malware-analysis/